<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rubik's Cube Trainer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f0f0f0;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .timer {
            text-align: center;
            font-size: 3em;
            font-weight: bold;
            color: #333;
            margin: 20px 0;
            padding: 20px;
            background: #f8f8f8;
            border-radius: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-box {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #2c5282;
        }
        
        .history {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            margin: 20px 0;
        }
        
        .time-entry {
            padding: 5px;
            margin: 2px 0;
            border-radius: 3px;
            display: flex;
            justify-content: space-between;
        }
        
        .time-entry.best { background: #ffffcc; }
        .time-entry.good { background: #ccffcc; }
        .time-entry.bad { background: #ffcccc; }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1em;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #45a049;
        }
        
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        .mode-selector {
            margin: 20px 0;
            text-align: center;
        }
        
        select {
            padding: 10px;
            font-size: 1em;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .instructions {
            background: #f0f8ff;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ² Rubik's Cube Trainer</h1>
        
        <div class="mode-selector">
            <label for="mode">Kies mode: </label>
            <select id="mode">
                <option value="speed">Speed Cubing</option>
                <option value="edge">Edge Pieces</option>
                <option value="corner">Corner Pieces</option>
            </select>
        </div>
        
        <div class="instructions">
            <strong>Hoe te gebruiken:</strong><br>
            â€¢ Druk op SPATIE om de timer te starten<br>
            â€¢ Druk nogmaals op SPATIE om te stoppen<br>
            â€¢ Druk ENTER om de tijd op te slaan<br>
        </div>
        
        <div class="timer" id="timer">0.000</div>
        
        <div class="controls">
            <button id="startBtn">Start Timer (SPATIE)</button>
            <button id="saveBtn" disabled>Tijd Opslaan (ENTER)</button>
            <button id="resetBtn">Reset Data</button>
        </div>
        
        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">Beste Tijd</div>
                <div class="stat-value" id="bestTime">-</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Gemiddelde (5)</div>
                <div class="stat-value" id="avg5">-</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Gemiddelde (12)</div>
                <div class="stat-value" id="avg12">-</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Totaal Solve</div>
                <div class="stat-value" id="totalSolves">0</div>
            </div>
        </div>
        
        <h3>Tijden Geschiedenis</h3>
        <div class="history" id="history">
            <p>Nog geen tijden opgeslagen...</p>
        </div>
    </div>

    <script>
        class CubeTrainer {
            constructor() {
                this.isRunning = false;
                this.startTime = 0;
                this.currentTime = 0;
                this.mode = 'speed';
                this.times = this.loadTimes();
                
                this.setupEventListeners();
                this.updateDisplay();
            }
            
            setupEventListeners() {
                // Keyboard events
                document.addEventListener('keydown', (e) => {
                    if (e.code === 'Space') {
                        e.preventDefault();
                        this.toggleTimer();
                    } else if (e.code === 'Enter') {
                        e.preventDefault();
                        this.saveTime();
                    }
                });
                
                // Button events
                document.getElementById('startBtn').addEventListener('click', () => this.toggleTimer());
                document.getElementById('saveBtn').addEventListener('click', () => this.saveTime());
                document.getElementById('resetBtn').addEventListener('click', () => this.resetData());
                document.getElementById('mode').addEventListener('change', (e) => this.changeMode(e.target.value));
            }
            
            toggleTimer() {
                if (!this.isRunning) {
                    this.startTimer();
                } else {
                    this.stopTimer();
                }
            }
            
            startTimer() {
                this.isRunning = true;
                this.startTime = Date.now();
                this.updateButtons();
                this.timerInterval = setInterval(() => this.updateTimer(), 10);
            }
            
            stopTimer() {
                this.isRunning = false;
                clearInterval(this.timerInterval);
                this.updateButtons();
            }
            
            updateTimer() {
                this.currentTime = (Date.now() - this.startTime) / 1000;
                document.getElementById('timer').textContent = this.currentTime.toFixed(3);
            }
            
            saveTime() {
                if (this.currentTime > 0) {
                    if (!this.times[this.mode]) {
                        this.times[this.mode] = [];
                    }
                    
                    this.times[this.mode].push({
                        time: this.currentTime,
                        date: new Date().toISOString()
                    });
                    
                    this.saveTimes();
                    this.updateDisplay();
                    this.resetTimer();
                }
            }
            
            resetTimer() {
                this.currentTime = 0;
                document.getElementById('timer').textContent = '0.000';
                this.updateButtons();
            }
            
            changeMode(newMode) {
                this.mode = newMode;
                this.resetTimer();
                this.updateDisplay();
            }
            
            updateButtons() {
                const startBtn = document.getElementById('startBtn');
                const saveBtn = document.getElementById('saveBtn');
                
                if (this.isRunning) {
                    startBtn.textContent = 'Stop Timer (SPATIE)';
                    saveBtn.disabled = true;
                } else {
                    startBtn.textContent = 'Start Timer (SPATIE)';
                    saveBtn.disabled = this.currentTime === 0;
                }
            }
            
            updateDisplay() {
                const modeTimes = this.times[this.mode] || [];
                
                // Update stats
                if (modeTimes.length > 0) {
                    const times = modeTimes.map(t => t.time).sort((a, b) => a - b);
                    
                    document.getElementById('bestTime').textContent = times[0].toFixed(3) + 's';
                    document.getElementById('totalSolves').textContent = times.length;
                    
                    // Average of 5
                    if (times.length >= 5) {
                        const recent5 = modeTimes.slice(-5).map(t => t.time).sort((a, b) => a - b);
                        const avg5 = (recent5.slice(1, 4).reduce((a, b) => a + b, 0) / 3);
                        document.getElementById('avg5').textContent = avg5.toFixed(3) + 's';
                    } else {
                        document.getElementById('avg5').textContent = '-';
                    }
                    
                    // Average of 12
                    if (times.length >= 12) {
                        const recent12 = modeTimes.slice(-12).map(t => t.time).sort((a, b) => a - b);
                        const avg12 = (recent12.slice(1, 11).reduce((a, b) => a + b, 0) / 10);
                        document.getElementById('avg12').textContent = avg12.toFixed(3) + 's';
                    } else {
                        document.getElementById('avg12').textContent = '-';
                    }
                } else {
                    document.getElementById('bestTime').textContent = '-';
                    document.getElementById('avg5').textContent = '-';
                    document.getElementById('avg12').textContent = '-';
                    document.getElementById('totalSolves').textContent = '0';
                }
                
                // Update history
                this.updateHistory();
            }
            
            updateHistory() {
                const history = document.getElementById('history');
                const modeTimes = this.times[this.mode] || [];
                
                if (modeTimes.length === 0) {
                    history.innerHTML = '<p>Nog geen tijden opgeslagen...</p>';
                    return;
                }
                
                const times = modeTimes.map(t => t.time);
                const best = Math.min(...times);
                const avg = times.reduce((a, b) => a + b, 0) / times.length;
                
                history.innerHTML = '';
                
                // Show last 10 times
                modeTimes.slice(-10).reverse().forEach(entry => {
                    const div = document.createElement('div');
                    div.className = 'time-entry';
                    
                    if (entry.time === best) {
                        div.classList.add('best');
                    } else if (entry.time < avg) {
                        div.classList.add('good');
                    } else {
                        div.classList.add('bad');
                    }
                    
                    div.innerHTML = `
                        <span>${entry.time.toFixed(3)}s</span>
                        <span>${new Date(entry.date).toLocaleTimeString()}</span>
                    `;
                    
                    history.appendChild(div);
                });
            }
            
            // Simple localStorage voor nu - later database
            loadTimes() {
                const saved = localStorage.getItem('cubeTrainerTimes');
                return saved ? JSON.parse(saved) : {};
            }
            
            saveTimes() {
                localStorage.setItem('cubeTrainerTimes', JSON.stringify(this.times));
            }
            
            resetData() {
                if (confirm('Weet je zeker dat je alle data wilt wissen?')) {
                    this.times = {};
                    this.saveTimes();
                    this.updateDisplay();
                    this.resetTimer();
                }
            }
        }
        
        // Start the application
        const trainer = new CubeTrainer();
    </script>
</body>
</html>